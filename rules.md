refactor files that becomes over 100 lines long and